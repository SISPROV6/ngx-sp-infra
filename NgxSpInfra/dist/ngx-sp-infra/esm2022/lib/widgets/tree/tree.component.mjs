import { Component, EventEmitter, Input, Output } from "@angular/core";
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "@angular/forms";
import * as i3 from "../svg-storage/svg-storage.component";
import * as i4 from "./pipes/search-tree.pipe";
export class TreeComponent {
    constructor() {
        // #region ==========> PROPERTIES <==========
        // #region PUBLIC
        this.items = [];
        this.checkbox = false;
        this.filter = false;
        this.onSelect = new EventEmitter();
        this.onEvent = new EventEmitter();
        this.checked = (item) => item.is_selected == true;
        this.search = "";
    }
    ngOnInit() { }
    // #endregion PUBLIC
    // #endregion ==========> PROPERTIES <==========
    // #region ==========> PUBLIC METHODS <==========
    onExpand(item) {
        if (item.expanded) {
            item.expanded = !item.expanded;
            return;
        }
        else {
            if (item.children) {
                if (item.children.length > 0) {
                    item.expanded = true;
                }
                else {
                    item.expanded = false;
                }
            }
        }
    }
    onCheck(items, item) {
        if (item.has_children) {
            item.children.forEach((firstNode) => {
                if (firstNode.is_selected != item.is_selected) {
                    firstNode.is_selected = !firstNode.is_selected;
                }
                if (firstNode.has_children) {
                    firstNode.children.forEach((secondNode) => {
                        if (secondNode.is_selected != firstNode.is_selected) {
                            secondNode.is_selected = !secondNode.is_selected;
                        }
                    });
                }
            });
        }
        if (this.indeterminateCheck(items)) {
            this.onSelect.emit(true);
        }
        else if (!this.indeterminateCheck(items)) {
            this.onSelect.emit(false);
        }
    }
    onCheckEvent(items) {
        if (this.indeterminateCheck(items)) {
            this.onEvent.emit(true);
        }
        else {
            this.onEvent.emit(false);
        }
    }
    // #endregion ==========> PUBLIC METHODS <==========
    // #region ==========> PRIVATE METHODS <==========
    indeterminateCheck(list) {
        return list.some(this.checked);
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.3.11", ngImport: i0, type: TreeComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "17.3.11", type: TreeComponent, selector: "app-tree", inputs: { items: "items", checkbox: "checkbox", filter: "filter" }, outputs: { onSelect: "onSelect", onEvent: "onEvent" }, ngImport: i0, template: "<!-- FILTER -->\r\n<ng-template [ngIf]=\"filter\">\r\n  <!-- <app-search-filters></app-search-filters> -->\r\n\r\n  <div class=\"input-group glb-search-input my-3\">\r\n    <span class=\"input-group-text search px-2 glb-bg-color-white\">\r\n      <app-svg-storage svgName=\"search\" svgColor=\"gray\" svgSize=\"medium-small\"\r\n        class=\"d-flex align-items-center\"></app-svg-storage>\r\n    </span>\r\n    <input type=\"text\" class=\"form-control border-left-none ps-0\" [(ngModel)]=\"search\">\r\n  </div>\r\n  \r\n</ng-template>\r\n<!-- TREE -->\r\n<ul class=\"tree-view\">\r\n  <ng-container *ngFor=\"let item of items | TreeFilter : search; index as i\">\r\n    <div class=\"container py-1\" [class]=\"!item.has_children ? 'children' : null \">\r\n      <app-svg-storage\r\n        class=\"chevron\"\r\n        *ngIf=\"item.has_children\"\r\n        [class]=\"item.aplicClass ? 'rotate' : null\"\r\n        (click)=\"\r\n          onExpand(item);\r\n          item.aplicClass ? (item.aplicClass = false) : (item.aplicClass = true)\r\n        \"\r\n        svgSize=\"medium-small\"\r\n        svgName=\"chevron-right\"\r\n      ></app-svg-storage>\r\n      <!-- CHECKBOX -->\r\n      <ng-template [ngIf]=\"checkbox\">\r\n        <input\r\n          type=\"checkbox\"\r\n          class=\"form-check-input m-0 position-relative\"\r\n          [checked]=\"onCheckEvent(items)\"\r\n          (change)=\"onCheck(items, item)\"\r\n          [(ngModel)]=\"item.is_selected\"\r\n        />\r\n      </ng-template>\r\n      <label class=\"label mb-0 ms-2\">{{ item.label }}</label>\r\n    </div>\r\n    <!-- NODES -->\r\n    <ul *ngIf=\"item.expanded\">\r\n      <app-tree\r\n        (onSelect)=\"item.is_selected = $event\"\r\n        (onEvent)=\"item.is_selected = $event\"\r\n        [items]=\"item.children\"\r\n        [checkbox]=\"checkbox\"\r\n      ></app-tree>\r\n    </ul>\r\n  </ng-container>\r\n</ul>", styles: ["*{font-family:Open Sans,Arial,Helvetica,sans-serif;color:#000;box-sizing:border-box;list-style:none;font-size:1rem}.tree-view{margin:0;padding:0;list-style-type:none;transition:all .3s ease-in-out}.container{margin:0;padding:0;display:flex;align-items:center}.chevron{position:relative;-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0);-webkit-transition:.3s ease-in-out;-moz-transition:.3s ease-in-out;-o-transition:.3s ease-in-out;transition:.3s ease-in-out;color:#000;cursor:pointer}.chevron:hover{color:#0d6efd;transform:rotate(30deg)}.chevron.rotate{transform:rotate(90deg);-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);-moz-transform:rotate(90deg);-o-transform:rotate(90deg);transition:.3s}.form-check-input{cursor:pointer}.children{padding-left:20px}\n"], dependencies: [{ kind: "directive", type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i2.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i2.CheckboxControlValueAccessor, selector: "input[type=checkbox][formControlName],input[type=checkbox][formControl],input[type=checkbox][ngModel]" }, { kind: "directive", type: i2.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i2.NgModel, selector: "[ngModel]:not([formControlName]):not([formControl])", inputs: ["name", "disabled", "ngModel", "ngModelOptions"], outputs: ["ngModelChange"], exportAs: ["ngModel"] }, { kind: "component", type: i3.SvgStorageComponent, selector: "app-svg-storage", inputs: ["svgName", "svgColor", "svgFill", "svgSize", "svgStrokeWidth"] }, { kind: "component", type: TreeComponent, selector: "app-tree", inputs: ["items", "checkbox", "filter"], outputs: ["onSelect", "onEvent"] }, { kind: "pipe", type: i4.SearchTreePipe, name: "TreeFilter" }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.3.11", ngImport: i0, type: TreeComponent, decorators: [{
            type: Component,
            args: [{ selector: "app-tree", template: "<!-- FILTER -->\r\n<ng-template [ngIf]=\"filter\">\r\n  <!-- <app-search-filters></app-search-filters> -->\r\n\r\n  <div class=\"input-group glb-search-input my-3\">\r\n    <span class=\"input-group-text search px-2 glb-bg-color-white\">\r\n      <app-svg-storage svgName=\"search\" svgColor=\"gray\" svgSize=\"medium-small\"\r\n        class=\"d-flex align-items-center\"></app-svg-storage>\r\n    </span>\r\n    <input type=\"text\" class=\"form-control border-left-none ps-0\" [(ngModel)]=\"search\">\r\n  </div>\r\n  \r\n</ng-template>\r\n<!-- TREE -->\r\n<ul class=\"tree-view\">\r\n  <ng-container *ngFor=\"let item of items | TreeFilter : search; index as i\">\r\n    <div class=\"container py-1\" [class]=\"!item.has_children ? 'children' : null \">\r\n      <app-svg-storage\r\n        class=\"chevron\"\r\n        *ngIf=\"item.has_children\"\r\n        [class]=\"item.aplicClass ? 'rotate' : null\"\r\n        (click)=\"\r\n          onExpand(item);\r\n          item.aplicClass ? (item.aplicClass = false) : (item.aplicClass = true)\r\n        \"\r\n        svgSize=\"medium-small\"\r\n        svgName=\"chevron-right\"\r\n      ></app-svg-storage>\r\n      <!-- CHECKBOX -->\r\n      <ng-template [ngIf]=\"checkbox\">\r\n        <input\r\n          type=\"checkbox\"\r\n          class=\"form-check-input m-0 position-relative\"\r\n          [checked]=\"onCheckEvent(items)\"\r\n          (change)=\"onCheck(items, item)\"\r\n          [(ngModel)]=\"item.is_selected\"\r\n        />\r\n      </ng-template>\r\n      <label class=\"label mb-0 ms-2\">{{ item.label }}</label>\r\n    </div>\r\n    <!-- NODES -->\r\n    <ul *ngIf=\"item.expanded\">\r\n      <app-tree\r\n        (onSelect)=\"item.is_selected = $event\"\r\n        (onEvent)=\"item.is_selected = $event\"\r\n        [items]=\"item.children\"\r\n        [checkbox]=\"checkbox\"\r\n      ></app-tree>\r\n    </ul>\r\n  </ng-container>\r\n</ul>", styles: ["*{font-family:Open Sans,Arial,Helvetica,sans-serif;color:#000;box-sizing:border-box;list-style:none;font-size:1rem}.tree-view{margin:0;padding:0;list-style-type:none;transition:all .3s ease-in-out}.container{margin:0;padding:0;display:flex;align-items:center}.chevron{position:relative;-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0);-webkit-transition:.3s ease-in-out;-moz-transition:.3s ease-in-out;-o-transition:.3s ease-in-out;transition:.3s ease-in-out;color:#000;cursor:pointer}.chevron:hover{color:#0d6efd;transform:rotate(30deg)}.chevron.rotate{transform:rotate(90deg);-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);-moz-transform:rotate(90deg);-o-transform:rotate(90deg);transition:.3s}.form-check-input{cursor:pointer}.children{padding-left:20px}\n"] }]
        }], ctorParameters: () => [], propDecorators: { items: [{
                type: Input
            }], checkbox: [{
                type: Input
            }], filter: [{
                type: Input
            }], onSelect: [{
                type: Output
            }], onEvent: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJlZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtc3AtaW5mcmEvc3JjL2xpYi93aWRnZXRzL3RyZWUvdHJlZS5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtc3AtaW5mcmEvc3JjL2xpYi93aWRnZXRzL3RyZWUvdHJlZS5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQVUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDOzs7Ozs7QUFRL0UsTUFBTSxPQUFPLGFBQWE7SUFDeEI7UUFJQSw2Q0FBNkM7UUFFN0MsaUJBQWlCO1FBQ0QsVUFBSyxHQUFxQixFQUFFLENBQUM7UUFDN0IsYUFBUSxHQUFZLEtBQUssQ0FBQztRQUMxQixXQUFNLEdBQVksS0FBSyxDQUFDO1FBRXZCLGFBQVEsR0FBMEIsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUNyRCxZQUFPLEdBQTBCLElBQUksWUFBWSxFQUFFLENBQUM7UUFFOUQsWUFBTyxHQUFHLENBQUMsSUFBYyxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsV0FBVyxJQUFJLElBQUksQ0FBQztRQUV2RCxXQUFNLEdBQVcsRUFBRSxDQUFDO0lBaEJaLENBQUM7SUFFaEIsUUFBUSxLQUFVLENBQUM7SUFlbkIsb0JBQW9CO0lBRXBCLGdEQUFnRDtJQUVoRCxpREFBaUQ7SUFDMUMsUUFBUSxDQUFDLElBQWM7UUFDNUIsSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDbEIsSUFBSSxDQUFDLFFBQVEsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUM7WUFDL0IsT0FBTztRQUNULENBQUM7YUFBTSxDQUFDO1lBQ04sSUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7Z0JBQ2xCLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUM7b0JBQzdCLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO2dCQUN2QixDQUFDO3FCQUFNLENBQUM7b0JBQ04sSUFBSSxDQUFDLFFBQVEsR0FBRyxLQUFLLENBQUM7Z0JBQ3hCLENBQUM7WUFDSCxDQUFDO1FBQ0gsQ0FBQztJQUNILENBQUM7SUFFTSxPQUFPLENBQUMsS0FBaUIsRUFBRSxJQUFjO1FBQzlDLElBQUksSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFDO1lBQ3RCLElBQUksQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxFQUFFLEVBQUU7Z0JBQ2xDLElBQUksU0FBUyxDQUFDLFdBQVcsSUFBSSxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7b0JBQzlDLFNBQVMsQ0FBQyxXQUFXLEdBQUcsQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDO2dCQUNqRCxDQUFDO2dCQUNELElBQUksU0FBUyxDQUFDLFlBQVksRUFBRSxDQUFDO29CQUMzQixTQUFTLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFVBQVUsRUFBRSxFQUFFO3dCQUN4QyxJQUFJLFVBQVUsQ0FBQyxXQUFXLElBQUksU0FBUyxDQUFDLFdBQVcsRUFBRSxDQUFDOzRCQUNwRCxVQUFVLENBQUMsV0FBVyxHQUFHLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQzt3QkFDbkQsQ0FBQztvQkFDSCxDQUFDLENBQUMsQ0FBQztnQkFDTCxDQUFDO1lBQ0gsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDO1FBQ0QsSUFBSSxJQUFJLENBQUMsa0JBQWtCLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQztZQUNuQyxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMzQixDQUFDO2FBQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1lBQzNDLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzVCLENBQUM7SUFDSCxDQUFDO0lBRU0sWUFBWSxDQUFDLEtBQWlCO1FBQ25DLElBQUksSUFBSSxDQUFDLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUM7WUFDbkMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDMUIsQ0FBQzthQUFNLENBQUM7WUFDTixJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUMzQixDQUFDO0lBQ0gsQ0FBQztJQUNELG9EQUFvRDtJQUVwRCxrREFBa0Q7SUFFMUMsa0JBQWtCLENBQUMsSUFBZ0I7UUFDekMsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNqQyxDQUFDOytHQXpFVSxhQUFhO21HQUFiLGFBQWEsMktDUjFCLDgzREFrREssbS9ERDFDUSxhQUFhOzs0RkFBYixhQUFhO2tCQUx6QixTQUFTOytCQUNFLFVBQVU7d0RBWUosS0FBSztzQkFBcEIsS0FBSztnQkFDVSxRQUFRO3NCQUF2QixLQUFLO2dCQUNVLE1BQU07c0JBQXJCLEtBQUs7Z0JBRVcsUUFBUTtzQkFBeEIsTUFBTTtnQkFDVSxPQUFPO3NCQUF2QixNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIElucHV0LCBPbkluaXQsIE91dHB1dCB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XHJcbmltcG9ydCB7IFRyZWVJdGVtIH0gZnJvbSBcIi4vbW9kZWxzL3RyZWUtaXRlbVwiO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6IFwiYXBwLXRyZWVcIixcclxuICB0ZW1wbGF0ZVVybDogXCIuL3RyZWUuY29tcG9uZW50Lmh0bWxcIixcclxuICBzdHlsZVVybHM6IFtcIi4vdHJlZS5jb21wb25lbnQuc2Nzc1wiXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgVHJlZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgY29uc3RydWN0b3IoKSB7fVxyXG5cclxuICBuZ09uSW5pdCgpOiB2b2lkIHt9XHJcblxyXG4gIC8vICNyZWdpb24gPT09PT09PT09PT4gUFJPUEVSVElFUyA8PT09PT09PT09PVxyXG5cclxuICAvLyAjcmVnaW9uIFBVQkxJQ1xyXG4gIEBJbnB1dCgpIHB1YmxpYyBpdGVtczogVHJlZUl0ZW1bXSB8IGFueSA9IFtdO1xyXG4gIEBJbnB1dCgpIHB1YmxpYyBjaGVja2JveDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gIEBJbnB1dCgpIHB1YmxpYyBmaWx0ZXI6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgQE91dHB1dCgpIHB1YmxpYyBvblNlbGVjdDogRXZlbnRFbWl0dGVyPGJvb2xlYW4+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG4gIEBPdXRwdXQoKSBwdWJsaWMgb25FdmVudDogRXZlbnRFbWl0dGVyPGJvb2xlYW4+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xyXG5cclxuICBwdWJsaWMgY2hlY2tlZCA9IChpdGVtOiBUcmVlSXRlbSkgPT4gaXRlbS5pc19zZWxlY3RlZCA9PSB0cnVlO1xyXG5cclxuICBwdWJsaWMgc2VhcmNoOiBzdHJpbmcgPSBcIlwiO1xyXG4gIC8vICNlbmRyZWdpb24gUFVCTElDXHJcblxyXG4gIC8vICNlbmRyZWdpb24gPT09PT09PT09PT4gUFJPUEVSVElFUyA8PT09PT09PT09PVxyXG5cclxuICAvLyAjcmVnaW9uID09PT09PT09PT0+IFBVQkxJQyBNRVRIT0RTIDw9PT09PT09PT09XHJcbiAgcHVibGljIG9uRXhwYW5kKGl0ZW06IFRyZWVJdGVtKTogdm9pZCB7XHJcbiAgICBpZiAoaXRlbS5leHBhbmRlZCkge1xyXG4gICAgICBpdGVtLmV4cGFuZGVkID0gIWl0ZW0uZXhwYW5kZWQ7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGlmIChpdGVtLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgaWYgKGl0ZW0uY2hpbGRyZW4ubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgaXRlbS5leHBhbmRlZCA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGl0ZW0uZXhwYW5kZWQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBvbkNoZWNrKGl0ZW1zOiBUcmVlSXRlbVtdLCBpdGVtOiBUcmVlSXRlbSk6IHZvaWQge1xyXG4gICAgaWYgKGl0ZW0uaGFzX2NoaWxkcmVuKSB7XHJcbiAgICAgIGl0ZW0uY2hpbGRyZW4uZm9yRWFjaCgoZmlyc3ROb2RlKSA9PiB7XHJcbiAgICAgICAgaWYgKGZpcnN0Tm9kZS5pc19zZWxlY3RlZCAhPSBpdGVtLmlzX3NlbGVjdGVkKSB7XHJcbiAgICAgICAgICBmaXJzdE5vZGUuaXNfc2VsZWN0ZWQgPSAhZmlyc3ROb2RlLmlzX3NlbGVjdGVkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZmlyc3ROb2RlLmhhc19jaGlsZHJlbikge1xyXG4gICAgICAgICAgZmlyc3ROb2RlLmNoaWxkcmVuLmZvckVhY2goKHNlY29uZE5vZGUpID0+IHtcclxuICAgICAgICAgICAgaWYgKHNlY29uZE5vZGUuaXNfc2VsZWN0ZWQgIT0gZmlyc3ROb2RlLmlzX3NlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgc2Vjb25kTm9kZS5pc19zZWxlY3RlZCA9ICFzZWNvbmROb2RlLmlzX3NlbGVjdGVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuaW5kZXRlcm1pbmF0ZUNoZWNrKGl0ZW1zKSkge1xyXG4gICAgICB0aGlzLm9uU2VsZWN0LmVtaXQodHJ1ZSk7XHJcbiAgICB9IGVsc2UgaWYgKCF0aGlzLmluZGV0ZXJtaW5hdGVDaGVjayhpdGVtcykpIHtcclxuICAgICAgdGhpcy5vblNlbGVjdC5lbWl0KGZhbHNlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHB1YmxpYyBvbkNoZWNrRXZlbnQoaXRlbXM6IFRyZWVJdGVtW10pIHtcclxuICAgIGlmICh0aGlzLmluZGV0ZXJtaW5hdGVDaGVjayhpdGVtcykpIHtcclxuICAgICAgdGhpcy5vbkV2ZW50LmVtaXQodHJ1ZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLm9uRXZlbnQuZW1pdChmYWxzZSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIC8vICNlbmRyZWdpb24gPT09PT09PT09PT4gUFVCTElDIE1FVEhPRFMgPD09PT09PT09PT1cclxuXHJcbiAgLy8gI3JlZ2lvbiA9PT09PT09PT09PiBQUklWQVRFIE1FVEhPRFMgPD09PT09PT09PT1cclxuXHJcbiAgcHJpdmF0ZSBpbmRldGVybWluYXRlQ2hlY2sobGlzdDogVHJlZUl0ZW1bXSk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIGxpc3Quc29tZSh0aGlzLmNoZWNrZWQpO1xyXG4gIH1cclxuXHJcbiAgLy8gcHJpdmF0ZSBhbGxDaGVjayhsaXN0OiBUcmVlSXRlbVtdKTogYm9vbGVhbiB7XHJcbiAgLy8gICByZXR1cm4gbGlzdC5ldmVyeSh0aGlzLmNoZWNrZWQpO1xyXG4gIC8vIH1cclxuICAvLyAjZW5kcmVnaW9uID09PT09PT09PT0+IFBSSVZBVEUgTUVUSE9EUyA8PT09PT09PT09PVxyXG59XHJcbiIsIjwhLS0gRklMVEVSIC0tPlxyXG48bmctdGVtcGxhdGUgW25nSWZdPVwiZmlsdGVyXCI+XHJcbiAgPCEtLSA8YXBwLXNlYXJjaC1maWx0ZXJzPjwvYXBwLXNlYXJjaC1maWx0ZXJzPiAtLT5cclxuXHJcbiAgPGRpdiBjbGFzcz1cImlucHV0LWdyb3VwIGdsYi1zZWFyY2gtaW5wdXQgbXktM1wiPlxyXG4gICAgPHNwYW4gY2xhc3M9XCJpbnB1dC1ncm91cC10ZXh0IHNlYXJjaCBweC0yIGdsYi1iZy1jb2xvci13aGl0ZVwiPlxyXG4gICAgICA8YXBwLXN2Zy1zdG9yYWdlIHN2Z05hbWU9XCJzZWFyY2hcIiBzdmdDb2xvcj1cImdyYXlcIiBzdmdTaXplPVwibWVkaXVtLXNtYWxsXCJcclxuICAgICAgICBjbGFzcz1cImQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXJcIj48L2FwcC1zdmctc3RvcmFnZT5cclxuICAgIDwvc3Bhbj5cclxuICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIGNsYXNzPVwiZm9ybS1jb250cm9sIGJvcmRlci1sZWZ0LW5vbmUgcHMtMFwiIFsobmdNb2RlbCldPVwic2VhcmNoXCI+XHJcbiAgPC9kaXY+XHJcbiAgXHJcbjwvbmctdGVtcGxhdGU+XHJcbjwhLS0gVFJFRSAtLT5cclxuPHVsIGNsYXNzPVwidHJlZS12aWV3XCI+XHJcbiAgPG5nLWNvbnRhaW5lciAqbmdGb3I9XCJsZXQgaXRlbSBvZiBpdGVtcyB8IFRyZWVGaWx0ZXIgOiBzZWFyY2g7IGluZGV4IGFzIGlcIj5cclxuICAgIDxkaXYgY2xhc3M9XCJjb250YWluZXIgcHktMVwiIFtjbGFzc109XCIhaXRlbS5oYXNfY2hpbGRyZW4gPyAnY2hpbGRyZW4nIDogbnVsbCBcIj5cclxuICAgICAgPGFwcC1zdmctc3RvcmFnZVxyXG4gICAgICAgIGNsYXNzPVwiY2hldnJvblwiXHJcbiAgICAgICAgKm5nSWY9XCJpdGVtLmhhc19jaGlsZHJlblwiXHJcbiAgICAgICAgW2NsYXNzXT1cIml0ZW0uYXBsaWNDbGFzcyA/ICdyb3RhdGUnIDogbnVsbFwiXHJcbiAgICAgICAgKGNsaWNrKT1cIlxyXG4gICAgICAgICAgb25FeHBhbmQoaXRlbSk7XHJcbiAgICAgICAgICBpdGVtLmFwbGljQ2xhc3MgPyAoaXRlbS5hcGxpY0NsYXNzID0gZmFsc2UpIDogKGl0ZW0uYXBsaWNDbGFzcyA9IHRydWUpXHJcbiAgICAgICAgXCJcclxuICAgICAgICBzdmdTaXplPVwibWVkaXVtLXNtYWxsXCJcclxuICAgICAgICBzdmdOYW1lPVwiY2hldnJvbi1yaWdodFwiXHJcbiAgICAgID48L2FwcC1zdmctc3RvcmFnZT5cclxuICAgICAgPCEtLSBDSEVDS0JPWCAtLT5cclxuICAgICAgPG5nLXRlbXBsYXRlIFtuZ0lmXT1cImNoZWNrYm94XCI+XHJcbiAgICAgICAgPGlucHV0XHJcbiAgICAgICAgICB0eXBlPVwiY2hlY2tib3hcIlxyXG4gICAgICAgICAgY2xhc3M9XCJmb3JtLWNoZWNrLWlucHV0IG0tMCBwb3NpdGlvbi1yZWxhdGl2ZVwiXHJcbiAgICAgICAgICBbY2hlY2tlZF09XCJvbkNoZWNrRXZlbnQoaXRlbXMpXCJcclxuICAgICAgICAgIChjaGFuZ2UpPVwib25DaGVjayhpdGVtcywgaXRlbSlcIlxyXG4gICAgICAgICAgWyhuZ01vZGVsKV09XCJpdGVtLmlzX3NlbGVjdGVkXCJcclxuICAgICAgICAvPlxyXG4gICAgICA8L25nLXRlbXBsYXRlPlxyXG4gICAgICA8bGFiZWwgY2xhc3M9XCJsYWJlbCBtYi0wIG1zLTJcIj57eyBpdGVtLmxhYmVsIH19PC9sYWJlbD5cclxuICAgIDwvZGl2PlxyXG4gICAgPCEtLSBOT0RFUyAtLT5cclxuICAgIDx1bCAqbmdJZj1cIml0ZW0uZXhwYW5kZWRcIj5cclxuICAgICAgPGFwcC10cmVlXHJcbiAgICAgICAgKG9uU2VsZWN0KT1cIml0ZW0uaXNfc2VsZWN0ZWQgPSAkZXZlbnRcIlxyXG4gICAgICAgIChvbkV2ZW50KT1cIml0ZW0uaXNfc2VsZWN0ZWQgPSAkZXZlbnRcIlxyXG4gICAgICAgIFtpdGVtc109XCJpdGVtLmNoaWxkcmVuXCJcclxuICAgICAgICBbY2hlY2tib3hdPVwiY2hlY2tib3hcIlxyXG4gICAgICA+PC9hcHAtdHJlZT5cclxuICAgIDwvdWw+XHJcbiAgPC9uZy1jb250YWluZXI+XHJcbjwvdWw+Il19
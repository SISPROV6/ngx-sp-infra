//Origem  https://pedrohtbranco.com.br/validacao-cpf-e-cnpj-com-angular-12/
export class CpfCnpjValidator {
    static { this.cpfLength = 11; }
    static { this.cnpjLength = 14; }
    /**
    * Calcula o dígito verificador do CPF ou CNPJ.
    */
    static buildDigit(arr) {
        const isCpf = arr.length < CpfCnpjValidator.cpfLength;
        const digit = arr
            .map((val, idx) => val * ((!isCpf ? idx % 8 : idx) + 2))
            .reduce((total, current) => total + current) % CpfCnpjValidator.cpfLength;
        if (digit < 2 && isCpf) {
            return 0;
        }
        else if (digit < 2) {
            return 0;
        }
        return CpfCnpjValidator.cpfLength - digit;
    }
    /**
    * Valida um CPF ou CNPJ de acordo com seu dígito verificador.
    */
    static validate(c) {
        const cpfCnpj = c.value.replace(/\D/g, '');
        if (cpfCnpj === '') {
            return null;
        }
        // Verifica o tamanho da string.
        if ([CpfCnpjValidator.cpfLength, CpfCnpjValidator.cnpjLength].indexOf(cpfCnpj.length) < 0) {
            return { cpcnpjInvalid: true };
        }
        // Verifica se todos os dígitos são iguais, exceto para CPF com dígitos zerados.
        if (/^([0-9])\1*$/.test(cpfCnpj) && cpfCnpj !== '00000000000') {
            return { cpcnpjInvalid: true };
        }
        // A seguir é realizado o cálculo verificador.
        const cpfCnpjArr = cpfCnpj.split('').reverse().slice(2);
        cpfCnpjArr.unshift(CpfCnpjValidator.buildDigit(cpfCnpjArr));
        cpfCnpjArr.unshift(CpfCnpjValidator.buildDigit(cpfCnpjArr));
        if (cpfCnpj !== cpfCnpjArr.reverse().join('')) {
            // Dígito verificador não é válido, resultando em falha.
            return { cpcnpjInvalidDigit: true };
        }
        return null;
    }
    /**
    * Implementa a interface de um validator.
    */
    validate(c) {
        return CpfCnpjValidator.validate(c);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3BmLWNucGoudmFsaWRhdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LXNwLWluZnJhL3NyYy9saWIvdmFsaWRhdG9ycy9jcGYtY25wai52YWxpZGF0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsMkVBQTJFO0FBRTNFLE1BQU0sT0FBTyxnQkFBZ0I7YUFFcEIsY0FBUyxHQUFHLEVBQUUsQ0FBQzthQUNmLGVBQVUsR0FBRyxFQUFFLENBQUM7SUFFdkI7O01BRUU7SUFDRixNQUFNLENBQUMsVUFBVSxDQUFDLEdBQWE7UUFFN0IsTUFBTSxLQUFLLEdBQUcsR0FBRyxDQUFDLE1BQU0sR0FBRyxnQkFBZ0IsQ0FBQyxTQUFTLENBQUM7UUFDdEQsTUFBTSxLQUFLLEdBQUcsR0FBRzthQUNkLEdBQUcsQ0FBQyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO2FBQ3ZELE1BQU0sQ0FBQyxDQUFDLEtBQUssRUFBRSxPQUFPLEVBQUUsRUFBRSxDQUFDLEtBQUssR0FBRyxPQUFPLENBQUMsR0FBRyxnQkFBZ0IsQ0FBQyxTQUFTLENBQUM7UUFFNUUsSUFBSSxLQUFLLEdBQUcsQ0FBQyxJQUFJLEtBQUssRUFBRSxDQUFDO1lBQ3ZCLE9BQU8sQ0FBQyxDQUFDO1FBQ1gsQ0FBQzthQUNJLElBQUksS0FBSyxHQUFHLENBQUMsRUFDbEIsQ0FBQztZQUNDLE9BQU8sQ0FBQyxDQUFDO1FBQ1gsQ0FBQztRQUVELE9BQU8sZ0JBQWdCLENBQUMsU0FBUyxHQUFHLEtBQUssQ0FBQztJQUM1QyxDQUFDO0lBR0Q7O01BRUU7SUFDRixNQUFNLENBQUMsUUFBUSxDQUFDLENBQWtCO1FBRWhDLE1BQU0sT0FBTyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQztRQUUzQyxJQUFJLE9BQU8sS0FBSyxFQUFFLEVBQUUsQ0FBQztZQUNuQixPQUFPLElBQUksQ0FBQztRQUNkLENBQUM7UUFFRCxnQ0FBZ0M7UUFDaEMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFNBQVMsRUFBRSxnQkFBZ0IsQ0FBQyxVQUFVLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDO1lBQzFGLE9BQU8sRUFBRSxhQUFhLEVBQUUsSUFBSSxFQUFFLENBQUM7UUFDakMsQ0FBQztRQUVELGdGQUFnRjtRQUNoRixJQUFJLGNBQWMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksT0FBTyxLQUFLLGFBQWEsRUFBRSxDQUFDO1lBQzlELE9BQU8sRUFBRSxhQUFhLEVBQUUsSUFBSSxFQUFFLENBQUM7UUFDakMsQ0FBQztRQUVELDhDQUE4QztRQUM5QyxNQUFNLFVBQVUsR0FBYSxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUVsRSxVQUFVLENBQUMsT0FBTyxDQUFDLGdCQUFnQixDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDO1FBQzVELFVBQVUsQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7UUFFNUQsSUFBSSxPQUFPLEtBQUssVUFBVSxDQUFDLE9BQU8sRUFBRSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDO1lBQzlDLHdEQUF3RDtZQUN4RCxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsSUFBSSxFQUFFLENBQUM7UUFDdEMsQ0FBQztRQUVELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVEOztNQUVFO0lBQ0YsUUFBUSxDQUFDLENBQWtCO1FBQ3pCLE9BQU8sZ0JBQWdCLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3RDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWYWxpZGF0b3IsIEFic3RyYWN0Q29udHJvbCB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuaW1wb3J0IHsgVmFsaWRhdGlvbkVycm9ycyB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuXHJcbi8vT3JpZ2VtICBodHRwczovL3BlZHJvaHRicmFuY28uY29tLmJyL3ZhbGlkYWNhby1jcGYtZS1jbnBqLWNvbS1hbmd1bGFyLTEyL1xyXG5cclxuZXhwb3J0IGNsYXNzIENwZkNucGpWYWxpZGF0b3IgaW1wbGVtZW50cyBWYWxpZGF0b3Ige1xyXG5cclxuICBzdGF0aWMgY3BmTGVuZ3RoID0gMTE7XHJcbiAgc3RhdGljIGNucGpMZW5ndGggPSAxNDtcclxuXHJcbiAgLyoqXHJcbiAgKiBDYWxjdWxhIG8gZMOtZ2l0byB2ZXJpZmljYWRvciBkbyBDUEYgb3UgQ05QSi5cclxuICAqL1xyXG4gIHN0YXRpYyBidWlsZERpZ2l0KGFycjogbnVtYmVyW10pOiBudW1iZXIge1xyXG5cclxuICAgIGNvbnN0IGlzQ3BmID0gYXJyLmxlbmd0aCA8IENwZkNucGpWYWxpZGF0b3IuY3BmTGVuZ3RoO1xyXG4gICAgY29uc3QgZGlnaXQgPSBhcnJcclxuICAgICAgLm1hcCgodmFsLCBpZHgpID0+IHZhbCAqICgoIWlzQ3BmID8gaWR4ICUgOCA6IGlkeCkgKyAyKSlcclxuICAgICAgLnJlZHVjZSgodG90YWwsIGN1cnJlbnQpID0+IHRvdGFsICsgY3VycmVudCkgJSBDcGZDbnBqVmFsaWRhdG9yLmNwZkxlbmd0aDtcclxuXHJcbiAgICBpZiAoZGlnaXQgPCAyICYmIGlzQ3BmKSB7XHJcbiAgICAgIHJldHVybiAwO1xyXG4gICAgfSBcclxuICAgIGVsc2UgaWYgKGRpZ2l0IDwgMikgXHJcbiAgICB7IFxyXG4gICAgICByZXR1cm4gMDsgXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIENwZkNucGpWYWxpZGF0b3IuY3BmTGVuZ3RoIC0gZGlnaXQ7XHJcbiAgfVxyXG5cclxuXHJcbiAgLyoqXHJcbiAgKiBWYWxpZGEgdW0gQ1BGIG91IENOUEogZGUgYWNvcmRvIGNvbSBzZXUgZMOtZ2l0byB2ZXJpZmljYWRvci5cclxuICAqL1xyXG4gIHN0YXRpYyB2YWxpZGF0ZShjOiBBYnN0cmFjdENvbnRyb2wpOiBWYWxpZGF0aW9uRXJyb3JzIHwgbnVsbCB7XHJcblxyXG4gICAgY29uc3QgY3BmQ25waiA9IGMudmFsdWUucmVwbGFjZSgvXFxEL2csICcnKTtcclxuXHJcbiAgICBpZiAoY3BmQ25waiA9PT0gJycpIHtcclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVmVyaWZpY2EgbyB0YW1hbmhvIGRhIHN0cmluZy5cclxuICAgIGlmIChbQ3BmQ25walZhbGlkYXRvci5jcGZMZW5ndGgsIENwZkNucGpWYWxpZGF0b3IuY25wakxlbmd0aF0uaW5kZXhPZihjcGZDbnBqLmxlbmd0aCkgPCAwKSB7XHJcbiAgICAgIHJldHVybiB7IGNwY25wakludmFsaWQ6IHRydWUgfTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBWZXJpZmljYSBzZSB0b2RvcyBvcyBkw61naXRvcyBzw6NvIGlndWFpcywgZXhjZXRvIHBhcmEgQ1BGIGNvbSBkw61naXRvcyB6ZXJhZG9zLlxyXG4gICAgaWYgKC9eKFswLTldKVxcMSokLy50ZXN0KGNwZkNucGopICYmIGNwZkNucGogIT09ICcwMDAwMDAwMDAwMCcpIHtcclxuICAgICAgcmV0dXJuIHsgY3BjbnBqSW52YWxpZDogdHJ1ZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEEgc2VndWlyIMOpIHJlYWxpemFkbyBvIGPDoWxjdWxvIHZlcmlmaWNhZG9yLlxyXG4gICAgY29uc3QgY3BmQ25wakFycjogbnVtYmVyW10gPSBjcGZDbnBqLnNwbGl0KCcnKS5yZXZlcnNlKCkuc2xpY2UoMik7XHJcblxyXG4gICAgY3BmQ25wakFyci51bnNoaWZ0KENwZkNucGpWYWxpZGF0b3IuYnVpbGREaWdpdChjcGZDbnBqQXJyKSk7XHJcbiAgICBjcGZDbnBqQXJyLnVuc2hpZnQoQ3BmQ25walZhbGlkYXRvci5idWlsZERpZ2l0KGNwZkNucGpBcnIpKTtcclxuXHJcbiAgICBpZiAoY3BmQ25waiAhPT0gY3BmQ25wakFyci5yZXZlcnNlKCkuam9pbignJykpIHtcclxuICAgICAgLy8gRMOtZ2l0byB2ZXJpZmljYWRvciBuw6NvIMOpIHbDoWxpZG8sIHJlc3VsdGFuZG8gZW0gZmFsaGEuXHJcbiAgICAgIHJldHVybiB7IGNwY25wakludmFsaWREaWdpdDogdHJ1ZSB9O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBJbXBsZW1lbnRhIGEgaW50ZXJmYWNlIGRlIHVtIHZhbGlkYXRvci5cclxuICAqL1xyXG4gIHZhbGlkYXRlKGM6IEFic3RyYWN0Q29udHJvbCk6IFZhbGlkYXRpb25FcnJvcnMgfCBudWxsIHtcclxuICAgIHJldHVybiBDcGZDbnBqVmFsaWRhdG9yLnZhbGlkYXRlKGMpO1xyXG4gIH1cclxufVxyXG4iXX0=